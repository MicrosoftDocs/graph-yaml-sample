### YamlMime:GraphOperation
uid: graph.opentypeextension_post_opentypeextension
metadata:
  content_git_url: https://github.com/microsoftgraph/microsoft-graph-docs/blob/master/api-reference/v1.0/api/opentypeextension_post_opentypeextension.md
summary:
  heading: "Create open extension"
  intro: |
    Create an open extension ([openTypeExtension](xref:graph.openTypeExtension) object) and add custom properties in a new or existing instance of a resource.
    
permissions:
  heading: "Permissions"
  intro: |
    One of the following permissions is required to call this API, depending on the resource you're creating the extension in. To learn more, including how to choose permissions, see [Permissions](../../../concepts/permissions_reference.md).
  list:
  - resource: ""
    permission: ""
  - resource: ""
    permission: ""
  - resource: ""
    permission: ""
  - resource: ""
    permission: ""
  - resource: ""
    permission: ""
httpRequest:
  heading: "HTTP request"
  outro: |
    ### Create an extension in a new resource instance
    Use the same REST request that you use to create the instance.
    
    ```http
    POST /users/{id|userPrincipalName}/events
    POST /users/{id|userPrincipalName}/messages
    POST /groups/{id}/events
    POST /groups/{id}/threads/{id}/posts/{id}/reply
    POST /users/{id|userPrincipalName}/contacts
    ```
    
    
    See the [Request body](#request-body) section about including the properties of the new resource instance _and the extension_ in the request body.
parameters:
  heading: "Path parameters"
  list:
  - name: "id"
    value: "String"
    description: "A unique identifier for an object in the corresponding collection. Required."
requestHeaders:
  heading: "Request headers"
  list:
  - name: "Authorization"
    value: "String"
    description: ""
  - name: "Content-Type"
    value: "String"
    description: ""
requestBody:
  heading: "Request body"
  intro: |
    Provide a JSON body of an [openTypeExtension](xref:graph.openTypeExtension), with the following required
    name-value pairs, and any additional custom data. The data in the JSON payload can be primitive types, or arrays of
    primitive types.
    |Name|Value
    |:-|:-|
    |@odata.type|microsoft.graph.openTypeExtension
    |extensionName|%unique_string%
    When creating an extension in a _new_ resource instance, in addition to the
    new **openTypeExtension** object, provide a JSON representation of the relevant properties to create such a resource instance.
response:
  heading: "Response"
  outro: |
    ### Response code
    Depending on the operation, the response code can be `201 Created` or `202 Accepted`.
    When you create an extension using the same operation that you use to create a resource instance, the operation returns the same response code that it returns when you use the operation to create the resource instance without the extension.
    Refer to the corresponding topics for creating the instance, as listed [above](#create-an-extension-in-a-new-resource-instance).
    |Scenario|Resource|Response body
    |:-|:-|:-|
    |Creating an extension while explicitly creating a _new_ resource instance|[contact](xref:graph.contact), [event](xref:graph.event), [message](xref:graph.message)|Includes the new instance expanded with the [openTypeExtension](xref:graph.openTypeExtension) object.
    |Creating an extension while implicitly creating a resource instance|[post](xref:graph.post)|The response includes only a response code but not a response body.
    |Creating an extension in an _existing_ resource instance|All supported resources|Includes the **openTypeExtension** object.
examples:
- items:
  - request:
      heading: "request"
      sampleCode: |
        ```http
        POST https://graph.microsoft.com/v1.0/me/messages
        
        {
          "subject": "Annual review",
          "body": {
            "contentType": "HTML",
            "content": "You should be proud!"
          },
          "toRecipients": [
            {
              "emailAddress": {
                "address": "rufus@contoso.com"
              }
            }
          ],
          "extensions": [
            {
              "@odata.type": "microsoft.graph.openTypeExtension",
              "extensionName": "Com.Contoso.Referral",
              "companyName": "Wingtip Toys",
              "expirationDate": "2015-12-30T11:00:00.000Z",
              "dealValue": 10000
            }
          ]
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        HTTP/1.1 201 Created
        Content-type: application/json
        
        {
          "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Me/messages/$entity",
          "@odata.id": "https://graph.microsoft.com/v1.0/users('ddfc984d-b826-40d7-b48b-57002df800e5@1717f226-49d1-4d0c-9d74-709fad664b77')/messages
        ('AAMkAGEbs88AAB84uLuAAA=')",
          "@odata.etag": "W/\"CQAAABYAAACY4MQpaFz9SbqUDe4+bs88AAB88LOj\"",
          "id": "AAMkAGEbs88AAB84uLuAAA=",
          "createdDateTime": "2015-10-30T03:03:43Z",
          "lastModifiedDateTime": "2015-10-30T03:03:43Z",
          "changeKey": "CQAAABYAAACY4MQpaFz9SbqUDe4+bs88AAB88LOj",
          "categories": [ ],
          "receivedDateTime": "2015-10-30T03:03:43Z",
          "sentDateTime": "2015-10-30T03:03:43Z",
          "hasAttachments": false,
          "subject": "Annual review",
          "body": {
            "contentType": "HTML",
            "content": "<html>\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\r
        \n<meta content=\"text/html; charset=us-ascii\">\r\n</head>\r\n<body>\r\nYou should be proud!\r\n</body>\r
        \n</html>\r\n"
          },
          "bodyPreview": "You should be proud!",
          "importance": "Normal",
          "parentFolderId": "AQMkAGEwAAAIBDwAAAA==",
          "sender": null,
          "from": null,
          "toRecipients": [
            {
              "emailAddress": {
                "address": "rufus@contoso.com",
                "name": "John Doe"
              }
            }
          ],
          "ccRecipients": [ ],
          "bccRecipients": [ ],
          "replyTo": [ ],
          "conversationId": "AAQkAGEFGugh3SVdMzzc=",
          "isDeliveryReceiptRequested": false,
          "isReadReceiptRequested": false,
          "isRead": true,
          "isDraft": true,
          "webLink": "https://outlook.office.com/owa/?
        ItemID=AAMkAGEbs88AAB84uLuAAA%3D&exvsurl=1&viewmodel=ReadMessageItem",
          "inferenceClassification": "Focused",
          "extensions@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Me/messages
        ('AAMkAGEbs88AAB84uLuAAA%3D')/extensions",
          "extensions": [
            {
              "@odata.type": "#microsoft.graph.openTypeExtension",
              "@odata.id": "https://graph.microsoft.com/v1.0/users('ddfc984d-b826-40d7-b48b-57002df800e5@1717f226-49d1-4d0c-9d74-709fad664b77')/messages
        ('AAMkAGEbs88AAB84uLuAAA=')/extensions('Microsoft.OutlookServices.OpenTypeExtension.Com.Contoso.Referral')",
              "id": "Microsoft.OutlookServices.OpenTypeExtension.Com.Contoso.Referral",
              "extensionName": "Com.Contoso.Referral",
              "companyName": "Wingtip Toys",
              "expirationDate": "2015-12-30T11:00:00.000Z",
              "dealValue": 10000
            }
          ]
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        POST https://graph.microsoft.com/v1.0/me/messages/AAMkAGE1M2IyNGNmLTI5MTktNDUyZi1iOTVl===/extensions
        
        {
          "@odata.type" : "microsoft.graph.openTypeExtension",
          "extensionName" : "Com.Contoso.Referral",
          "companyName" : "Wingtip Toys",
          "dealValue" : 500050,
          "expirationDate" : "2015-12-03T10:00:00.000Z"
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        HTTP/1.1 201 Created
        Content-type: application/json
        
        {
            "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Me/messages('AAMkAGE1M2IyNGNmLTI5MTktNDUyZi1iOTVl===')/extensions/$entity",
            "@odata.type": "#microsoft.graph.openTypeExtension",
            "@odata.id": "https://graph.microsoft.com/v1.0/users('ddfc984d-b826-40d7-b48b-57002df85e00@1717f226-49d1-4d0c-9d74-709fad6677b4')/messages('AAMkAGE1M2IyNGNmLTI5MTktNDUyZi1iOTVl===')/extensions
        ('Microsoft.OutlookServices.OpenTypeExtension.Com.Contoso.Referral')",
            "extensionName": "Com.Contoso.Referral",
            "id": "Microsoft.OutlookServices.OpenTypeExtension.Com.Contoso.Referral",
            "companyName": "Wingtip Toys",
            "dealValue": 500050,
            "expirationDate": "2015-12-03T10:00:00.000Z"
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        POST https://graph.microsoft.com/v1.0/groups/f5480dfd-7d77-4d0b-ba2e-3391953cc74a/events/AAMkADVl17IsAAA=/extensions
        
        {
          "@odata.type" : "microsoft.graph.openTypeExtension",
          "extensionName" : "Com.Contoso.Deal",
          "companyName" : "Alpine Skis",
          "dealValue" : 1010100,
          "expirationDate" : "2015-07-03T13:04:00.000Z"
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        HTTP/1.1 201 Created
        Content-type: application/json
        
        {
            "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#groups('f5480dfd-7d77-4d0b-ba2e-3391953cc74a')/events('AAMkADVl7IsAAA%3D')/extensions/$entity",
            "@odata.type": "#microsoft.graph.openTypeExtension",
            "id": "Microsoft.OutlookServices.OpenTypeExtension.Com.Contoso.Deal",
            "extensionName": "Com.Contoso.Deal",
            "companyName": "Alpine Skis",
            "dealValue": 1010100,
            "expirationDate": "2015-07-03T13:04:00Z"
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        POST https://graph.microsoft.com/v1.0/groups/37df2ff0-0de0-4c33-8aee-75289364aef6/threads/AAQkADJizZJpEWwqDHsEpV_KA==/posts/AAMkADJiUg96QZUkA-ICwMubAAC1heiSAAA=/reply
        
        {
          "post": {
            "body": {
              "contentType": "html",
              "content": "<html><body><div><div><div><div>When and where? </div></div></div></div></body></html>"
            },
          "extensions": [
            {
              "@odata.type": "Microsoft.OutlookServices.OpenTypeExtension",
              "extensionName": "Com.Contoso.HR",
              "companyName": "Contoso",
              "expirationDate": "2015-07-03T13:04:00.000Z",
              "topPicks": [
                "Employees only",
                "Add spouse or guest",
                "Add family"
              ]
            }
          ]
          }
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        HTTP/1.1 202 Accepted
        Content-type: text/plain
        Content-Length: 0
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        POST https://graph.microsoft.com/v1.0/groups/37df2ff0-0de0-4c33-8aee-75289364aef6/conversations
        
        {
          "Topic": "Does anyone have a second?",
          "Threads": [
            {
              "Posts": [
                {
                  "Body": {
                    "ContentType": "HTML",
                    "Content": "This is urgent!"
                  },
                  "Extensions": [
                    {
                      "@odata.type": "Microsoft.OutlookServices.OpenTypeExtension",
                      "extensionName": "Com.Contoso.Benefits",
                      "companyName": "Contoso",
                      "expirationDate": "2016-08-03T11:00:00.000Z",
                      "topPicks": [
                        "Employees only",
                        "Add spouse or guest",
                        "Add family"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
        ```
        
  - request:
      heading: "request"
      sampleCode: |
        ```http
        HTTP/1.1 201 Created
        Content-type: application/json
        
        {
            "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#groups('37df2ff0-0de0-4c33-8aee-75289364aef6')/conversations/$entity",
            "id": "AAQkADJToRlbJ5Mg7TFM7H-j3Y=",
            "threads@odata.context": "https://graph.microsoft.com/v1.0/$metadata#groups('37df2ff0-0de0-4c33-8aee-75289364aef6')/conversations('AAQkADJToRlbJ5Mg7TFM7H-j3Y%3D')/threads",
            "threads": [
                {
                    "id": "AAQkADJDtMUzsf_PdhAAswJOhGVsnkyDtMUzsf_Pdg=="
                }
            ]
        }
        ```
        
