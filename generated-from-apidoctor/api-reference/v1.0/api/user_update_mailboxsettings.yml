### YamlMime:GraphOperation
uid: graph.user_update_mailboxsettings
metadata:
  content_git_url: https://github.com/microsoftgraph/microsoft-graph-docs/blob/master/api-reference/v1.0/api/user_update_mailboxsettings.md
summary:
  heading: "Update user mailbox settings"
  intro: |
    Update one or more settings for the user's mailbox. This includes settings for [automatic replies](xref:graph.automaticrepliessetting) (notify people automatically upon receipt of their email), [locale](xref:graph.localeinfo) (language and country/region), time zone, and [working hours](xref:graph.workinghours).
    You can enable, configure, or disable one or more of these settings as part of [mailboxSettings](xref:graph.mailboxsettings).
    **Note** You cannot create or delete any mailbox settings.
    When you update the preferred time zone for a user, you can specify it in the Windows or  [Internet Assigned Numbers Authority (IANA) time zone](http://www.iana.org/time-zones) (also known as Olson time zone) format.
permissions:
  heading: "Permissions"
  intro: |
    One of the following permissions is required to call this API. To learn more, including how to choose permissions, see [Permissions](xref:graph.permissions_reference).
  list:
  - resource: "Delegated (work or school account)"
    permission: "MailboxSettings.ReadWrite"
  - resource: "Delegated (personal Microsoft account)"
    permission: "MailboxSettings.ReadWrite"
  - resource: "Application"
    permission: "MailboxSettings.ReadWrite"
httpRequest:
  heading: "HTTP request"
  sampleCode: |
    ```http
    PATCH /me/mailboxSettings
    PATCH /users/{id|userPrincipalName}/mailboxSettings
    ```
    
queryParameters:
  heading: "Optional query parameters"
  intro: |
    This method supports the [OData Query Parameters](http://developer.microsoft.com/en-us/graph/docs/overview/query_parameters) to help customize the response.
requestHeaders:
  heading: "Request headers"
  list:
  - name: "Authorization"
    value: "String"
    description: "Bearer {token}. Required."
requestBody:
  heading: "Request body"
  intro: |
    In the request body, supply the values for the relevant properties that should be updated. Existing properties that are not included in the 
    request body will maintain their previous values or be recalculated based on changes to other property values. For best performance you 
    shouldn't include existing values that haven't changed. The following are the writable/updatable properties:
    |Property|Type|Description
    |:-|:-|:-|
    |automaticRepliesSetting|[automaticRepliesSetting](xref:graph.automaticrepliessetting)|Configuration settings to automatically notify the sender of an incoming email with a message from the signed-in user. You can set such notifications for only a future date range.
    |language|[localeInfo](xref:graph.localeinfo)|The locale information for the user, including the preferred language and country/region.
    |timeZone|string|The default time zone for the user's mailbox.
    |workingHours|[workingHours](xref:graph.workinghours)|The hours, days of a week, and time zone that the user works.
response:
  heading: "Response"
  intro: |
    If successful, this method returns a `200 OK` response code and [mailboxSettings](xref:graph.mailboxSettings) object in the response body.
  outro: |
    ## Errors
    Setting working hours with inappropriate values may return the following errors.
    |Scenario|HTTP status code|Error code|Error message
    |:-|:-|:-|:-|
    |Invalid **startTime** or **endTime**|400|RequestBodyRead|Cannot convert the literal '08' to the expected type 'Edm.TimeOfDay'.
    |Start time is greater than end time|400|ErrorInvalidTimeSettings|Start Time should occur before End Time.
    |Invalid day in **daysOfWeek**|400|InvalidArguments|Requested value 'RandomDay' was not found.
    |Invalid **timeZone**|400|InvalidTimeZone|Time Zone settings provided are invalid.
examples:
  - items:
    - Example:
        heading: "Example"
        request:
            heading: "Request"
            intro: |
              The first example enables automatic replies for a date range, by setting the following properties of the **automaticRepliesSetting** property:
              **status**, **scheduledStartDateTime** and **scheduledEndDateTime**.
            sampleCode: |
              ```http
              PATCH https://graph.microsoft.com/v1.0/me/mailboxSettings
              Content-Type: application/json
              
              {
                  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Me/mailboxSettings",
                  "automaticRepliesSetting": {
                      "status": "Scheduled",
                      "scheduledStartDateTime": {
                        "dateTime": "2016-03-20T18:00:00.0000000",
                        "timeZone": "UTC"
                      },
                      "scheduledEndDateTime": {
                        "dateTime": "2016-03-28T18:00:00.0000000",
                        "timeZone": "UTC"
                      }
                  }
              }
              ```
              
        response:
            heading: "Response"
            intro: |
              The response includes the updated settings for automatic replies. Note: The response object shown here may be truncated for brevity. All of the properties will be returned from an actual call.
            sampleCode: |
              ```http
              HTTP/1.1 200 OK
              Content-type: application/json
              
              {
                  "@odata.context": "https://graph.microsoft.com/v1.0/$metadata#Me/mailboxSettings",
                  "automaticRepliesSetting": {
                      "status": "scheduled",
                      "externalAudience": "all",
                      "scheduledStartDateTime": {
                          "dateTime": "2016-03-20T02:00:00.0000000",
                          "timeZone": "UTC"
                      },
                      "scheduledEndDateTime": {
                          "dateTime": "2016-03-28T02:00:00.0000000",
                          "timeZone": "UTC"
                      },
                  "internalReplyMessage": "<html>\n<body>\n<p>I'm at our company's worldwide reunion and will respond to your message as soon as I return.<br>\n</p></body>\n</html>\n",
                  "externalReplyMessage": "<html>\n<body>\n<p>I'm at the Contoso worldwide reunion and will respond to your message as soon as I return.<br>\n</p></body>\n</html>\n"
                  }
              }
              ```
              
            outro: |
              ##### Request 2
              The second example customizes the time zone for the working hours of the signed-in user, by setting the **timeZone** property 
              to a [custom time zone](xref:graph.customtimezone).
              
              ```http
              PATCH https://graph.microsoft.com/v1.0/me/mailboxSettings
              Content-Type: application/json
              
              {
                "workingHours": {
                    "endTime" : "18:30:00.0000000", 
                    "daysOfWeek": [ 
                        "Monday", 
                        "Tuesday", 
                        "Wednesday", 
                        "Thursday", 
                        "Friday", 
                        "Saturday" 
                    ], 
                    "timeZone" : { 
                       "@odata.type": "#microsoft.graph.customTimeZone", 
                       "bias":-300, 
                       "name": "Customized Time Zone",
                       "standardOffset":{   
                         "time":"02:00:00.0000000", 
                         "dayOccurrence":2, 
                         "dayOfWeek":"Sunday", 
                         "month":10, 
                         "year":0 
                       }, 
                       "daylightOffset":{   
                         "daylightBias":100, 
                         "time":"02:00:00.0000000", 
                         "dayOccurrence":4, 
                         "dayOfWeek":"Sunday", 
                         "month":5, 
                         "year":0 
                       } 
                    } 
                }
              }
              ```
              
