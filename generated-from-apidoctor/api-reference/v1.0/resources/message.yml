### YamlMime:GraphResource
uid: graph.message
metadata:
  content_git_url: https://github.com/microsoftgraph/microsoft-graph-docs/blob/master/api-reference/v1.0/resources/xref:graph.message
summary:
  heading: message resource type
  intro: |
    A message in a mailFolder.
    This resource supports:
    
    * Adding your own data to custom properties using [extensions](xref:graph.extensibility_overview).
    * Using [delta query](xref:graph.delta_query_overview) to track incremental additions, deletions, and updates, 
    by providing a [delta](xref:graph.message_delta) function.
    
methods:
  heading: Methods
  list:
  - method: [List messages](xref:graph.user_list_messages)
    type: [message](xref:graph.message) collection
    description: Get all the messages in the signed-in user's mailbox (including the Deleted Items and Clutter folders).
  - method: [Create message](xref:graph.user_post_messages)
    type: [message](xref:graph.message)
    description: Create a draft of a new message.
  - method: [Get message](xref:graph.message_get)
    type: [message](xref:graph.message)
    description: Read properties and relationships of message object.
  - method: [Update](xref:graph.message_update)
    type: [message](xref:graph.message)
    description: Update message object.
  - method: [Delete](xref:graph.message_delete)
    type: None
    description: Delete message object.
  - method: [copy](xref:graph.message_copy)
    type: [Message](xref:graph.message)
    description: Copy a message to a folder.
  - method: [createForward](xref:graph.message_createforward)
    type: [Message](xref:graph.message)
    description: Create a draft of the Forward message. You can then update or send the draft.
  - method: [createReply](xref:graph.message_createreply)
    type: [Message](xref:graph.message)
    description: Create a draft of the Reply message. You can then update or send the draft.
  - method: [createReplyAll](xref:graph.message_createreplyall)
    type: [Message](xref:graph.message)
    description: Create a draft of the Reply All message. You can then update or send the draft.
  - method: [delta](xref:graph.message_delta)
    type: [message](xref:graph.message) collection
    description: Get a set of messages that have been added, deleted, or updated in a specified folder.
  - method: [forward](xref:graph.message_forward)
    type: None
    description: Forward a message. The message is then saved in the Sent Items folder.
  - method: [move](xref:graph.message_move)
    type: [Message](xref:graph.message)
    description: Move the message to a folder. This creates a new copy of the message in the destination folder.
  - method: [reply](xref:graph.message_reply)
    type: None
    description: Reply to the sender of a message. The message is then saved in the Sent Items folder.
  - method: [replyAll](xref:graph.message_replyall)
    type: None
    description: Reply to all recipients of a message. The message is then saved in the Sent Items folder.
  - method: [send](xref:graph.message_send)
    type: None
    description: Sends a previously created message draft. The message is then saved in the Sent Items folder.
  - method: **Attachments**
    type: 
    description: 
  - method: [List attachments](xref:graph.message_list_attachments)
    type: [Attachment](xref:graph.attachment) collection
    description: Gets all attachments on a message.
  - method: [Add attachment](xref:graph.message_post_attachments)
    type: [Attachment](xref:graph.attachment)
    description: Add a new attachment to a message by posting to the attachments collection.
  - method: **Open extensions**
    type: 
    description: 
  - method: [Create open extension](xref:graph.opentypeextension_post_opentypeextension)
    type: [openTypeExtension](xref:graph.opentypeextension)
    description: Create an open extension and add custom properties in a new or existing instance of a resource.
  - method: [Get open extension](xref:graph.opentypeextension_get)
    type: [openTypeExtension](xref:graph.opentypeextension) collection
    description: Get an open extension object or objects identified by name or fully qualified name.
  - method: **Schema extensions**
    type: 
    description: 
  - method: [Add schema extension values](xref:graph.extensibility_schema_groups)
    type: 
    description: Create a schema extension definition and then use it to add custom typed data to a resource.
  - method: **Extended properties**
    type: 
    description: 
  - method: [Create single-value extended property](xref:graph.singlevaluelegacyextendedproperty_post_singlevalueextendedproperties)
    type: [message](xref:graph.message)
    description: Create one or more single-value extended properties in a new or existing message.
  - method: [Get message with single-value extended property](xref:graph.singlevaluelegacyextendedproperty_get)
    type: [message](xref:graph.message)
    description: Get messages that contain a single-value extended property by using $expand or $filter.
  - method: [Create multi-value extended property](xref:graph.multivaluelegacyextendedproperty_post_multivalueextendedproperties)
    type: [message](xref:graph.message)
    description: Create one or more multi-value extended properties in a new or existing message.
  - method: [Get message with multi-value extended property](xref:graph.multivaluelegacyextendedproperty_get)
    type: [message](xref:graph.message)
    description: Get a message that contains a multi-value extended property by using $expand.
resource:
  heading: JSON representation
  intro: |
    Here is a JSON representation of the resource
  sampleCode: |
    ```json
    {
      "bccRecipients": [{"@odata.type": "microsoft.graph.recipient"}],
      "body": {"@odata.type": "microsoft.graph.itemBody"},
      "bodyPreview": "string",
      "categories": ["string"],
      "ccRecipients": [{"@odata.type": "microsoft.graph.recipient"}],
      "changeKey": "string",
      "conversationId": "string",
      "createdDateTime": "String (timestamp)",
      "flag": {"@odata.type": "microsoft.graph.followupFlag"},
      "from": {"@odata.type": "microsoft.graph.recipient"},
      "hasAttachments": true,
      "id": "string (identifier)",
      "importance": "String",
      "inferenceClassification": "String",
      "internetMessageHeaders": [{"@odata.type": "microsoft.graph.internetMessageHeader"}],
      "internetMessageId": "String",
      "isDeliveryReceiptRequested": true,
      "isDraft": true,
      "isRead": true,
      "isReadReceiptRequested": true,
      "lastModifiedDateTime": "String (timestamp)",
      "parentFolderId": "string",
      "receivedDateTime": "String (timestamp)",
      "replyTo": [{"@odata.type": "microsoft.graph.recipient"}],
      "sender": {"@odata.type": "microsoft.graph.recipient"},
      "sentDateTime": "String (timestamp)",
      "subject": "string",
      "toRecipients": [{"@odata.type": "microsoft.graph.recipient"}],
      "uniqueBody": {"@odata.type": "microsoft.graph.itemBody"},
      "webLink": "string",
    
      "attachments": [{"@odata.type": "microsoft.graph.attachment"}],
      "extensions": [{"@odata.type": "microsoft.graph.extension"}],
      "multiValueExtendedProperties": [{"@odata.type": "microsoft.graph.multiValueLegacyExtendedProperty"}],
      "singleValueExtendedProperties": [{"@odata.type": "microsoft.graph.singleValueLegacyExtendedProperty"}]
    }
    ```
    
  outro: |
    ## See also
    
    * [Get mailbox settings](xref:graph.user_get_mailboxsettings) 
    * [Update mailbox settings](xref:graph.user_update_mailboxsettings)
    * [Use delta query to track changes in Microsoft Graph data](xref:graph.delta_query_overview)
    * [Get incremental changes to messages in a folder](xref:graph.delta_query_messages)
    * [Add custom data to resources using extensions](xref:graph.extensibility_overview)
    * [Add custom data to users using open extensions](xref:graph.extensibility_open_users)
    * [Add custom data to groups using schema extensions](xref:graph.extensibility_schema_groups)
    
properties:
  heading: Properties
  list:
  - property: bccRecipients
    type: Collection(microsoft.graph.recipient)
    description: The Bcc: recipients for the message.
  - property: body
    type: microsoft.graph.itemBody
    description: The body of the message. It can be in HTML or text format.
  - property: bodyPreview
    type: String
    description: The first 255 characters of the message body. It is in text format.
  - property: categories
    type: Collection(String)
    description: The categories associated with the message.
  - property: ccRecipients
    type: Collection(microsoft.graph.recipient)
    description: The Cc: recipients for the message.
  - property: changeKey
    type: String
    description: The version of the message.
  - property: conversationId
    type: String
    description: The ID of the conversation the email belongs to.
  - property: createdDateTime
    type: DateTimeOffset
    description: The date and time the message was created.
  - property: flag
    type: microsoft.graph.followupFlag
    description: The flag value that indicates the status, start date, due date, or completion date for the message.
  - property: from
    type: microsoft.graph.recipient
    description: The mailbox owner and sender of the message.
  - property: hasAttachments
    type: Boolean
    description: Indicates whether the message has attachments. This property doesn't include inline attachments, so if a message contains only inline attachments, this property is false. To verify the existence of inline attachments, parse the body property to look for a src attribute, such as <IMG src="cid:image001.jpg@01D26CD8.6C05F070">.
  - property: id
    type: String
    description: Unique identifier for the message (note that this value may change if a message is moved or altered)
  - property: importance
    type: microsoft.graph.importance
    description: The importance of the message: Low, Normal, High.
  - property: inferenceClassification
    type: microsoft.graph.inferenceClassificationType
    description: The classification of the message for the user, based on inferred relevance or importance, or on an explicit override. The possible values are: focused or other.
  - property: internetMessageHeaders
    type: Collection(microsoft.graph.internetMessageHeader)
    description: The collection of message headers, defined by RFC5322, that provide details of the network path taken by a message from the sender to the recipient. Read-only.
  - property: internetMessageId
    type: String
    description: The message ID in the format specified by RFC2822.
  - property: isDeliveryReceiptRequested
    type: Boolean
    description: Indicates whether a read receipt is requested for the message.
  - property: isDraft
    type: Boolean
    description: Indicates whether the message is a draft. A message is a draft if it hasn't been sent yet.
  - property: isRead
    type: Boolean
    description: Indicates whether the message has been read.
  - property: isReadReceiptRequested
    type: Boolean
    description: Indicates whether a read receipt is requested for the message.
  - property: lastModifiedDateTime
    type: DateTimeOffset
    description: The date and time the message was last changed.
  - property: parentFolderId
    type: String
    description: The unique identifier for the message's parent mailFolder.
  - property: receivedDateTime
    type: DateTimeOffset
    description: The date and time the message was received.
  - property: replyTo
    type: Collection(microsoft.graph.recipient)
    description: The email addresses to use when replying.
  - property: sender
    type: microsoft.graph.recipient
    description: The account that is actually used to generate the message.
  - property: sentDateTime
    type: DateTimeOffset
    description: The date and time the message was sent.
  - property: subject
    type: String
    description: The subject of the message.
  - property: toRecipients
    type: Collection(microsoft.graph.recipient)
    description: The To: recipients for the message.
  - property: uniqueBody
    type: microsoft.graph.itemBody
    description: The part of the body of the message that is unique to the current message. uniqueBody is not returned by default but can be retrieved for a given message by use of the ?$select=uniqueBody query. It can be in HTML or text format.
  - property: webLink
    type: String
    description: The URL to open the message in Outlook Web App.You can append an ispopout argument to the end of the URL to change how the message is displayed. If ispopout is not present or if it is set to 1, then the message is shown in a popout window. If ispopout is set to 0, then the browser will show the message in the Outlook Web App review pane.The message will open in the browser if you are logged in to your mailbox via Outlook Web App. You will be prompted to login if you are not already logged in with the browser.This URL can be accessed from within an iFrame.
  outro: |
    **Removing script from the body property**
    The message body can be either HTML or text. If the body is HTML, by default, any potentially unsafe HTML (for example, JavaScript) embedded in the **body** property would be removed before the body content is returned in a REST response.
    To get the entire, original HTML content, include the following HTTP request header:
    Prefer: outlook.allow-unsafe-html

    **Setting the from and sender properties**
    When a message is being composed, in most cases, the From and Sender properties represent the same signed-in user, unless either is updated as described in the following scenarios:
    
    * The **from** property can be changed if the Exchange administrator has assigned **sendAs** rights of the mailbox to some other users. The administrator can do this by selecting **Mailbox Permissions** of the mailbox owner in the Azure portal, or by using the Exchange Admin Center or a Windows PowerShell Add-ADPermission cmdlet. Then, you can programmatically set the **from** property to one of these users who have **sendAs** rights for that mailbox.
    * The **sender** property can be changed if the mailbox owner has delegated one or more users to be able to send messages from that mailbox. The mailbox owner can delegate in Outlook. When a delegate sends a message on behalf of the mailbox owner, the **sender** property is set to the delegate’s account, and the **from** property remains as the mailbox owner. Programmatically, you can set the **sender** property to a user who has got delegate right for that mailbox.
    
relationships:
  heading: Relationships
  list:
  - relationship: attachments
    type: Collection(microsoft.graph.attachment)
    description: The fileAttachment and itemAttachment attachments for the message.
  - relationship: extensions
    type: Collection(microsoft.graph.extension)
    description: The collection of open extensions defined for the message. Read-only. Nullable.
  - relationship: multiValueExtendedProperties
    type: Collection(microsoft.graph.multiValueLegacyExtendedProperty)
    description: The collection of multi-value extended properties defined for the message. Read-only. Nullable.
  - relationship: singleValueExtendedProperties
    type: Collection(microsoft.graph.singleValueLegacyExtendedProperty)
    description: The collection of single-value extended properties defined for the message. Read-only. Nullable.
